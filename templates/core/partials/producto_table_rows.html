{% for producto in productos %}
<tr>
  <td><span class="text-muted">{{ producto.codigo }}</span></td>
  <td>
    <div class="d-flex py-1 align-items-center">
        {% if producto.imagen %}
            <span class="avatar me-2" style="background-image: url({{ producto.imagen.url }})"></span>
        {% else %}
            <span class="avatar me-2 bg-secondary-lt">{{ producto.nombre|slice:":2" }}</span>
        {% endif %}
        
        <div class="flex-fill">
            <div class="font-weight-medium">{{ producto.nombre }}</div>
            </div>
    </div>
  </td>
  <td>{{ producto.categoria.nombre|default:"--" }}</td>
  <td>
      {% if producto.stock <= producto.stock_minimo %}
        <span class="badge bg-red-lt">{{ producto.stock }} {{ producto.get_unidad_medida_base_display }}</span>
      {% else %}
        <span class="text-secondary">{{ producto.stock }} {{ producto.get_unidad_medida_base_display }}</span>
      {% endif %}
  </td>
  <td>
      <small class="text-secondary">{{ producto.stock_minimo|floatformat:0 }} / {{ producto.stock_maximo|default_if_none:"NA" }}</small>
  </td>
  <td>${{ producto.precio_costo }}</td>
  <td>
      {% if producto.activo %}
        <span class="status status-green">Activo</span>
      {% else %}
        <span class="status status-grey">Inactivo</span>
      {% endif %}
  </td>
  <td class="text-center">
    <div class="dropdown">
        <button class="btn dropdown-toggle align-text-top" onclick="toggleAccionesProducto(event, this)" aria-expanded="false">
            Acciones
        </button>
        
        
        
        <div class="dropdown-menu dropdown-menu-end">
            <a class="dropdown-item fw-bold text-blue" 
                href="#" 
                hx-get="{% url 'gestionar_presentaciones' pk=producto.pk %}" 
                hx-target="#dialog" 
                data-bs-toggle="modal"
                data-bs-target="#modal-generic">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-inline me-1 text-blue" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 5h-2a2 2 0 0 0 -2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-12a2 2 0 0 0 -2 -2h-2" /><path d="M9 3m0 2a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v0a2 2 0 0 1 -2 2h-2a2 2 0 0 1 -2 -2z" /><path d="M9 14h.01" /><path d="M9 17h.01" /><path d="M12 16l1 1l3 -3" /></svg>
                Equivalencias
             </a>
             <a class="dropdown-item" 
                href="#" 
                hx-get="{% url 'editar_producto' pk=producto.pk %}" 
                hx-target="#dialog" 
                data-bs-toggle="modal"
                data-bs-target="#modal-generic">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-inline me-1" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 20h4l10.5 -10.5a1.5 1.5 0 0 0 -4 -4l-10.5 10.5v4" /><path d="M13.5 6.5l4 4" /></svg>
                Editar
             </a>
             
             <a class="dropdown-item text-danger" 
                href="#"
                hx-get="{% url 'eliminar_producto' pk=producto.pk %}" 
                hx-target="#dialog" 
                data-bs-toggle="modal"
                data-bs-target="#modal-generic">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-inline me-1" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><line x1="4" y1="7" x2="20" y2="7" /><line x1="10" y1="11" x2="10" y2="17" /><line x1="14" y1="11" x2="14" y2="17" /><path d="M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12" /><path d="M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3" /></svg>
                Eliminar
             </a>
        </div>
    </div>
  </td>
</tr>
{% empty %}
<tr>
    <td colspan="8" class="text-center py-5">
        <div class="empty">
            <p class="empty-title">No hay productos en el inventario</p>
        </div>
    </td>
</tr>
{% endfor %}