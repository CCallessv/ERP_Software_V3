{% extends 'base.html' %}
{% load static %}

{% block full_content %}
<div class="page-header d-print-none">
  <div class="container-fluid">
    <div class="row g-2 align-items-center">
      <div class="col">
        <h2 class="page-title">Inventario</h2>
        <div class="text-secondary mt-1">Gestiona tus productos, subproductos y stock</div>
      </div>
      <div class="col-auto ms-auto d-print-none">
        <div class="btn-list">
          <span class="d-none d-sm-inline">
            <a href="#" class="btn btn-white">
              <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2 -2v-2" /><path d="M7 11l5 5l5 -5" /><path d="M12 4l0 12" /></svg>
              Importar
            </a>
          </span>
          <a href="#" class="btn btn-white d-none d-sm-inline-block">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2 -2v-2" /><path d="M7 11l5 -5l5 5" /><path d="M12 4l0 12" /></svg>
            Exportar
          </a>
          <button class="btn btn-primary d-none d-sm-inline-block" 
                  hx-get="{% url 'crear_producto' %}" 
                  hx-target="#dialog" 
                  data-bs-toggle="modal" 
                  data-bs-target="#modal-generic">
              <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><line x1="12" y1="5" x2="12" y2="19" /><line x1="5" y1="12" x2="19" y2="12" /></svg>
              Nuevo Producto
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="page-body">
  <div class="container-fluid">
    
    <div class="row row-cards mb-4">
        
        <div class="col-sm-6 col-lg-2">
            <div class="card card-sm">
                <div class="card-body">
                    <div class="row align-items-center">
                        <div class="col-auto">
                            <span class="bg-primary text-white avatar">
                                <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><polyline points="12 3 20 7.5 20 16.5 12 21 4 16.5 4 7.5 12 3" /><line x1="12" y1="12" x2="20" y2="7.5" /><line x1="12" y1="12" x2="12" y2="21" /><line x1="12" y1="12" x2="4" y2="7.5" /></svg>
                            </span>
                        </div>
                        <div class="col">
                            <div class="font-weight-medium">{{ total_productos }}</div>
                            <div class="text-secondary">Total productos</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-sm-6 col-lg-2">
            <div class="card card-sm">
                <div class="card-body">
                    <div class="row align-items-center">
                        <div class="col-auto">
                            <span class="bg-orange text-white avatar">
                                <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 9v2m0 4v.01" /><path d="M5 19h14a2 2 0 0 0 1.84 -2.75l-7.1 -12.25a2 2 0 0 0 -3.5 0l-7.1 12.25a2 2 0 0 0 1.75 2.75" /></svg>
                            </span>
                        </div>
                        <div class="col">
                            <div class="font-weight-medium">{{ stock_bajo }}</div>
                            <div class="text-secondary">Stock bajo</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-sm-6 col-lg-4"> 
            <div class="card card-sm">
                <div class="card-body">
                    <div class="row align-items-center">
                        <div class="col-auto">
                            <span class="bg-yellow text-white avatar">
                                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-currency-dollar" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M16.7 8a3 3 0 0 0 -2.7 -2h-4a3 3 0 0 0 0 6h4a3 3 0 0 1 0 6h-4a3 3 0 0 1 -2.7 -2" /><path d="M12 3v3m0 12v3" /></svg>
                            </span>
                        </div>
                        <div class="col">
                            <div class="font-weight-medium">${{ valor_total|floatformat:2 }}</div>
                            <div class="text-secondary">Valor total inventario</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="card">
      <div class="card-body border-bottom py-3">
        <div class="d-flex">
          <div class="text-secondary">
            <div class="input-icon">
                <span class="input-icon-addon">
                  <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="10" cy="10" r="7" /><line x1="21" y1="21" x2="15" y2="15" /></svg>
                </span>
                <input type="text" class="form-control" placeholder="Buscar por nombre o SKU..." aria-label="Buscar en inventario">
              </div>
          </div>
          <div class="ms-auto text-secondary">
             <select class="form-select d-inline-block w-auto">
                 <option>Todas las categorías</option>
             </select>
             <select class="form-select d-inline-block w-auto ms-2">
                <option>Todos los tipos</option>
            </select>
          </div>
        </div>
      </div>
      
      <div class="table-responsive">
        <table class="table card-table table-vcenter text-nowrap datatable">
          <thead>
            <tr>
              <th class="w-1">SKU</th>
              <th>PRODUCTO</th>
              <th>CATEGORÍA</th>
              <th>STOCK</th>
              <th>MÍN/MÁX</th>
              <th>COSTO PROM.</th>
              <th>ESTADO</th>
              <th class="w-1 text-center">ACCIONES</th>
            </tr>
          </thead>
          <tbody id="tabla-productos" 
                 hx-get="{% url 'productos_list' %}" 
                 hx-trigger="productoActualizado from:body">
             
             {% include 'core/partials/producto_table_rows.html' %}
             
          </tbody>
        </table>
      </div>
      
      <div class="card-footer d-flex align-items-center">
        <p class="m-0 text-secondary">Mostrando <span>0</span> a <span>0</span> de <span>0</span> productos</p>
        <ul class="pagination m-0 ms-auto">
          <li class="page-item disabled"><a class="page-link" href="#">prev</a></li>
          <li class="page-item disabled"><a class="page-link" href="#">next</a></li>
        </ul>
      </div>
    </div>

  </div>
</div>
<script src="{% static 'js/dropdown_AccionesProductos.js' %}"></script>
{% endblock %}